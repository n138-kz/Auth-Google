<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Auth-Google</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://accounts.google.com/gsi/client" async defer></script>
	<script src="https://www.google.com/recaptcha/api.js?render=6LfCHdcUAAAAAOwkHsW_7W7MfoOrvoIw9CXdLRBA"></script>
	<style>
		:root {
			--default-font-size: 16pt;
			--default-margin-padding-size: 0;
			--default-background-color: #F0FFFFFF;
			--default-text-color: #000000FF;
		}
		:root[theme=dark] {
			--default-background-color: #000000FF;
			--default-text-color: #F00000FF;
		}
		html, body {
			margin: var(--default-margin-padding-size);
			padding: var(--default-margin-padding-size);
			background-color: var(--default-background-color);
			color: var(--default-text-color);
			font-size: var(--default-font-size);
		}
		body {
			margin: 0 auto;
			width: 90%;
			text-align: center;
		}
		@keyframes rotate1 {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}
	</style>
	<style>
		div.div_button {
			padding: 10px 15px;
			border-radius: 50% / 100%;
			margin-top: 1px;
		}
		a {
			text-decoration: none;
		}
		a:hover {
			text-decoration: underline;
		}
	</style>
	<style>
		.g_id_signin iframe {
			margin: 0 auto !important;
		}
	</style>
	<script>
		window.addEventListener('DOMContentLoaded', (e)=>{
			const html_top = document.createElement('a');
			html_top.name='_';
			document.querySelector('body').prepend(html_top);
		}, false);
		window.addEventListener('DOMContentLoaded', (e)=>{
			let favicon;
			['icon', 'apple-touch-icon', 'favicon'].forEach((e)=>{
				favicon = document.createElement('link');
				favicon.rel = '<link rel="icon" href="/favicon.ico">';
				favicon.rel = 'icon';
				favicon.href = 'https://www.google.com/s2/favicons?size=64&domain=https://google.com/';
				document.querySelectorAll('head').forEach((e)=>e.prepend(favicon));
			});
		}, false);
		window.addEventListener('DOMContentLoaded', (e)=>{
			let header1 = document.createElement('h1');
			let header1_link = document.createElement('a');
			header1_link.href = './';
			header1_link.title = document.title;
			let header1_text = document.createTextNode(document.title);
			header1_link.appendChild(header1_text);
			header1.appendChild(header1_link);
			document.querySelectorAll('body').forEach((e)=>e.prepend(header1));
		}, false);
	</script>
	<script>
		async function sha256(text){
			/**
			* @quote
				https://qiita.com/economist/items/768d2f6a10d54d4fa39f
			* @usage
				sha256(document.querySelector(':root').innerHTML).then(hash => console.log(hash));
			*/
			const uint8  = new TextEncoder().encode(text)
			const digest = await crypto.subtle.digest('SHA-256', uint8)
			return Array.from(new Uint8Array(digest)).map(v => v.toString(16).padStart(2,'0')).join('')
		}
		async function hash_encode(encode, text){
			/**
			* @docs
				https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest
			* @args encode::text
				- SHA-1
				- SHA-256
				- SHA-384
				- SHA-512
			* @args text::text
				.*
			*/
			const uint8  = new TextEncoder().encode(text)
			const digest = await crypto.subtle.digest(encode, uint8)
			return Array.from(new Uint8Array(digest)).map(v => v.toString(16).padStart(2,'0')).join('')
		}
	</script>
	<script>
		function getLatestDeployGithub(requestUri) {
			var dom_messages;
			var dom_messages_outputs;
			var dom_messages_code;
			/* fetch */
			fetch(requestUri, {
				method: 'GET',
			})
			.then(response => {
				console.debug(response);
				if (false) {
				} else if ( response.status === 200 ) {
					return response.json()
				} else if ( response.status >= 400 ) {
					throw new Error(`[${response.status}]Error has occured. server-message:${response.message} ${response.documentation_url}`);
				}
			})
			.then(response => response[0].statuses_url)
			.then(deployLatest_url => {
				console.log(deployLatest_url);
				return fetch(deployLatest_url, {
					method: 'GET',
				}).then(response => response.json())
				.then(response => {
					return response[0];
				});
			})
			.then(response => {
				sessionStorage.setItem( (btoa(location.href)).slice(0, 16) + '.'+'github', JSON.stringify(response) );
				return response;
			})
			.catch(exception => {
				console.error(exception);
			});
		}
		function checkupdate_self() {
			let latestDeployGithub = getLatestDeployGithub('https://api.github.com/repos/n138-kz/Auth-Google/deployments');
			/*
			idが違って、stateがsuccessの時ページ再読み込み
			*/
		}
		window.addEventListener('DOMContentLoaded', (e)=>{
			sessionStorage.setItem( (btoa(location.href)).slice(0, 16) + '.'+'github',
			getLatestDeployGithub('https://api.github.com/repos/n138-kz/mondai_3/deployments') );

			checkupdate_self();
			sessionStorage.setItem( (btoa(location.href)).slice(0, 16) + '.'+'interval_checkupdate_self',
				/* 5min */
				setInterval(checkupdate_self, (300 * 1000))
			);

			sessionStorage.setItem( (btoa(location.href)).slice(0, 16) + '.'+'timeout_checkupdate_self',
				setTimeout(()=>{if (location.host != 'n138-kz.github.io') {location.replace('https://n138-kz.github.io/Auth-Google/html/')}}, 100)
			);
		}, false);
		function getGithubDeployStatus() {
			fetch('https://api.github.com/repos/n138-kz/Auth-Google/deployments', {
				method: 'GET',
			})
			.then(r=>{
				if (false) {
				} else if ( r.status === 200 ) {
					return r.json()
				} else if ( r.status >= 400 ) {
					throw new Error(`[${r.status}]Error has occured. server-message:${r.message}, (${r.documentation_url})`);
				}
			})
			.then(r=>r[0])
			.then(r=>{
				console.log(r);
				document.querySelectorAll('#github_deploy a').item(0).innerText = r.sha.substr(0,7);
				return r;
			})
			.then(r=>r.repository_url)
			.then(r=>{
				console.log(r);
				fetch(r, {
					method: 'GET',
				})
				.then(r=>{
					if (false) {
					} else if ( r.status === 200 ) {
						return r.json()
					} else if ( r.status >= 400 ) {
						let http = r.status;
						r = r.json();
						throw new Error(`[${http}]Error has occured. server-message:${r.message}, (${r.documentation_url})`);
					}
				})
				.then(r=>{
					document.querySelectorAll('#github_deploy a').item(0).href = r.html_url;
				})
			});
		}
		window.addEventListener('DOMContentLoaded', (e)=>{
			let content1 = document.createElement('div');
			content1.id = 'github_deploy';
			let content2 = document.createElement('a');
			content2.innerText = '';
			
			content1.style.position = 'fixed';
			content1.style.bottom = '1.5em';
			content1.style.left = '0';
			content1.style.maxWidth = '40%';
			content1.style.height = '1em';
			content1.style.width = '20ex';
			content1.style.fontFamily = '"Myrica M", "Myrica N", "Myrica P", monospace';
			content1.style.backgroundColor = 'var(--default-background-color)';
			content1.style.textAlign = 'left';
			content1.style.marginLeft = '5px';
			
			getGithubDeployStatus();
			sessionStorage.setItem( (btoa(location.href)).slice(0, 16) + '.'+'interval_checkdeploystatus_self',
				/* 5min */
				setInterval(getGithubDeployStatus, (30 * 1000))
			);

			content1.appendChild( content2 );
			document.body.appendChild( content1 );
		}, false);
	</script>
	<script defer>
		window.addEventListener('DOMContentLoaded', (e)=>{
			let g_id_signin = document.createElement('div');
			g_id_signin.classList.add('div_button');
			g_id_signin.classList.add('g_id_signin');
			g_id_signin.dataset.type = 'standard';
			g_id_signin.dataset.shape = 'rectangular';
			g_id_signin.dataset.theme = 'outline';
			g_id_signin.dataset.text = 'signin_with';
			g_id_signin.dataset.size = 'large';
			g_id_signin.dataset.logo_alignment = 'left';
			document.querySelector('body').appendChild(g_id_signin);

			let g_id_onload = document.createElement('div');
			g_id_onload.id = 'g_id_onload';
			g_id_onload.dataset.client_id = '784669840257-i0a06p3o6g8k0k1tk26jj09li1q2acud.apps.googleusercontent.com';
			g_id_onload.dataset.context='signin';
			g_id_onload.dataset.login_uri = 'https://n138-kz.github.io';
			g_id_onload.dataset.callback = 'onSignIn';
			g_id_onload.dataset.ux_mode='popup';
			g_id_onload.dataset.auto_select='true';
			g_id_onload.dataset.itp_support='true';
			document.querySelector('body').appendChild(g_id_onload);
		}, false);
	</script>
	<script>
		window.addEventListener('DOMContentLoaded', (e)=>{
			let content = document.createElement('div');
			content.id = 'authn_status';
			content.innerText = 'anonymous';
			document.body.appendChild( content );
		}, false);
		window.addEventListener('DOMContentLoaded', (e)=>{
			let content = document.createElement('div');
			content.id = 'locate_clock';
			content.innerText = '';
			document.body.appendChild( content );
			sessionStorage.setItem( (btoa(location.href)).slice(0, 16) + '.'+'interval_locate_clock',
				setInterval(()=>{
					let cycle_clock = new Date();
					cycle_clock = {
						FullYear : (''+cycle_clock.getFullYear()),
						Month : ('00'+(cycle_clock.getMonth()+1)).substr(-2),
						Date : ('00'+cycle_clock.getDate()).substr(-2),
						Hours : ('00'+cycle_clock.getHours()).substr(-2),
						Minutes : ('00'+cycle_clock.getMinutes()).substr(-2),
						Seconds : ('00'+cycle_clock.getSeconds()).substr(-2),
					}
					cycle_clock.datestr = cycle_clock.FullYear + '/' + cycle_clock.Month + '/' + cycle_clock.Date;
					cycle_clock.timestr = cycle_clock.Hours + ':' + cycle_clock.Minutes + ':' + cycle_clock.Seconds;
					document.querySelector('#locate_clock').innerText = cycle_clock.datestr + ' ' + cycle_clock.timestr;
				}, 100)
			);
		}, false);
		window.addEventListener('DOMContentLoaded', (e)=>{
			let content1 = document.createElement('div');
			content1.id = 'link_policy';
			let content2 = document.createElement('a');
			content2.href = 'https://n138-kz.github.io/policy/';
			content2.innerText = 'Policy Notes';
			content1.appendChild( content2 );
			document.body.appendChild( content1 );
		}, false);
	</script>
	<style>
		#locate_clock {
			position: fixed;
			top: 0;
			right: 0;
			max-width: 40%;
			height: 1em;
			width: 300px;
			font-family: "Myrica M", "Myrica N", "Myrica P", monospace;
			background-color: var(--default-background-color);
			text-align: right;
		}
		#authn_status {
			position: fixed;
			top: 1em;
			right: 0;
			max-width: 40%;
			height: 1em;
			width: 300px;
			font-family: "Myrica M", "Myrica N", "Myrica P", monospace;
			background-color: var(--default-background-color);
			background-repeat: no-repeat;
			background-size: contain;
			text-align: right;
			background-position-x: right;
		}
		#link_policy {
			position: fixed;
			bottom: 0.5em;
			left: 0;
			max-width: 40%;
			height: 1em;
			width: 20ex;
			font-family: "Myrica M", "Myrica N", "Myrica P", monospace;
			background-color: var(--default-background-color);
			text-align: left;
			margin-left: 5px;
		}
		table.authn_result_landscape {
			background-color: var(--default-background-color);
			margin: 0 auto;
		}
		table.authn_result_landscape th {
			text-align: center;
		}
		table.authn_result_landscape td {
			text-align: left;
		}
		table.authn_result_landscape img {
			border-radius: 20%;
		}
		div.authn_result_portrait {
			background-color: var(--default-background-color);
			text-align: left;
		}
		div.authn_result_portrait .block2,
		div.authn_result_portrait .block3,
		div.authn_result_portrait .block4 {
			margin-left: 25px;
		}
		div.authn_result_portrait h2,
		div.authn_result_portrait h3,
		div.authn_result_portrait h4 {
			margin: 0;
		}
		div.authn_result_portrait img {
			border-radius: 50%;
		}
		@media all {
			.authn_result_landscape {
				display: none;
			}
			.authn_result_portrait {
				display: none;
			}
		}
		@media screen and (orientation: landscape) {
			table.authn_result_landscape {
				display: table;
			}
		}
		@media screen and (orientation: portrait) {
			div.authn_result_portrait {
				display: grid;
			}
		}
	</style>
	<script>
		function pickout_token() {
			let params = JSON.parse( sessionStorage.getItem((btoa(location.href)).slice(0, 16) + '.'+'googleauthn') );

			/* time of expiry */
			if ( !(new Date().getTime()/1000 > params.credential.iat) || !(new Date().getTime()/1000 < params.credential.exp) ) {
				return null;
			}

			return params;
		}
		function reAuthn(params) {
			if (!params) { return false; }
			console.log(
				[
					new Date().getTime()/1000,
					params.credential.iat,
					params.credential.exp,
					(new Date().getTime()/1000 > params.credential.iat),
					(new Date().getTime()/1000 < params.credential.exp),
				]
			)
			/* time of expiry */
			if ( !(new Date().getTime()/1000 > params.credential.iat) || !(new Date().getTime()/1000 < params.credential.exp) ) {
				return false;
			}

			fetch(params.requestUri, {
				method: 'POST',
				body: JSON.stringify({
					ts: (Math.floor((new Date()).getTime()/1000)),
					credential: params.credential.credential,
					clientId: params.credential.clientId,
				}),
				cache: 'no-cache',
				headers: {
					'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8',
				},
			})
			.then(response => {
				console.debug(response);
				if (false) {
				} else if ( response.status === 200 ) {
					return response.json()
				} else if ( response.status >= 400 ) {
					throw new Error(`[${response.status}]Error has occured. server-message:${response.message} ${response.documentation_url}`);
				}
			})
			.catch(exception => {
				console.error(exception);
			});
		}
		function onSignIn(params) {
			let fullscreen_wp;
			fullscreen_wp = document.querySelectorAll('.fullscreen_wp');
			Array.prototype.forEach.call(fullscreen_wp, (e)=>{ e.remove(); });
			fullscreen_wp = document.createElement('div');
			fullscreen_wp.style.backgroundColor = '#c0c0c0c0'; /* near eq silver(#C0C0C0) */
			fullscreen_wp.style.left = '0px';
			fullscreen_wp.style.top = '0px';
			fullscreen_wp.style.position = 'fixed';
			fullscreen_wp.style.width = '100%';
			fullscreen_wp.style.height = '100%';
			fullscreen_wp.style.zIndex = '10000';
			fullscreen_wp.classList.add('fullscreen_wp');
			let loading_img = document.createElement('img');
			loading_img.src = '12675.svg';
			loading_img.alt = '12675';
			loading_img.style.maxWidth = '80%';
			loading_img.style.maxHeight = '80%';
			loading_img.style.animationName = 'rotate1';
			loading_img.style.animationDuration = '1.5s';
			loading_img.style.animationTimingFunction = 'ease';
			loading_img.style.animationIterationCount = 'infinite';
			fullscreen_wp.appendChild(loading_img);
			document.querySelector('body').appendChild(fullscreen_wp);
			params.requestUri = 'https://authn.n138.jp/google/';
			console.log([params, JSON.stringify(params)]);

			try {
				let xhr = new XMLHttpRequest();
				xhr.onreadystatechange = () => {
					if ( xhr.readyState === 4 && xhr.status === 200 ) {
						let responseText = xhr.responseText;
						let response = JSON.parse(responseText);
						console.log(response);
						/* authned */
						let token = {
							credential: {
								credential: params.credential,
								token: params.credential,
								clientId: params.clientId,
								client_id: params.clientId,
								requestUri: params.requestUri,
								request_uri: params.requestUri,
								withinexpire: false,
								with_in_expire: (
									((new Date()).getTime()/1000) > response.google.session.iat
									&&
									((new Date()).getTime()/1000) < response.google.session.exp
								),
								iat: response.google.session.iat,
								iat_humanable: {
									jst: new Date((response.google.session.iat)*1000).toLocaleString('ja-JP', { timeZone: 'jst' }),
									utc: new Date((response.google.session.iat)*1000).toUTCString(),
								},
								exp: response.google.session.exp,
								exp_humanable: {
									jst: new Date((response.google.session.exp)*1000).toLocaleString('ja-JP', { timeZone: 'jst' }),
									utc: new Date((response.google.session.exp)*1000).toUTCString(),
								},
								remote: response.remote,
							},
							sessions: {
								id: response.authn.sessions.id,
								name: response.authn.sessions.name,
							},
							iat: response.issue_at,
						}
						token.credential.withinexpire = token.credential.with_in_expire;
						sessionStorage.setItem( (btoa(location.href)).slice(0, 16) + '.'+'googleauthn',
							JSON.stringify(token)
						);
						sessionStorage.setItem( '_' + '.'+'googleauthn', JSON.stringify(token) );

						authn_displayblock = document.createElement('div');
						authn_displayblock.style.backgroundColor = '#F0FFFF';
						document.querySelector('#authn_status').innerText = response.google.user.name;
						document.querySelector('#authn_status').style.backgroundImage = `url(${response.google.user.icon})`;

						/*
						* @sample
							response = {
								http: {
									code: 200
								},
								error: {
									code: 0
								},
								issue_at: (new Date()).getTime()/1000,
								last_checkpoint: 119,
								remote: '127.0.0.1:65535',
								google: {
									session: {
										iat: (new Date()).getTime()/1000,
										exp: (new Date()).getTime()/1000,
									},
									user: {
										userid: 'test-id-01',
										email: 'test@example.net',
										name: 'test, test',
										icon: 'https://lh3.googleusercontent.com/a/ACg8ocKm8zMAS24gpR1uksfUAXPG5gDSevDZdYPgtfXetrK0nVRN=s96-c',
									}
								}
							}
						/* * */
						/* sample landscape */
						authn_displayblock_table = document.createElement('table');
						authn_displayblock_table.classList.add('authn_result_landscape');
						authn_displayblock_table.border = 1;
						authn_displayblock_table_section = document.createElement('tbody');
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'http';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'code';authn_displayblock_table_td.colSpan = 2;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = response.http.code;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'error';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'code';authn_displayblock_table_td.colSpan = 2;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = response.error.code;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'issue_at';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'issue_at';authn_displayblock_table_td.colSpan = 2;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = (new Date(response.issue_at*1000)).toLocaleString();authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'last_checkpoint';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'code';authn_displayblock_table_td.colSpan = 2;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = response.last_checkpoint;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'remote';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'address';authn_displayblock_table_td.colSpan = 2;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = response.remote;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'authn';authn_displayblock_table_td.rowSpan = 2;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'session';authn_displayblock_table_td.rowSpan = 2;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'id';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = response.authn.sessions.id;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'name';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = response.authn.sessions.name;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'google';authn_displayblock_table_td.rowSpan = 8;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'token';authn_displayblock_table_td.rowSpan = 2;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'clientId';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = (params.clientId + '.' + location.host).split('.')[0];authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'credential';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = '****************';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'session';authn_displayblock_table_td.rowSpan = 2;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'iat';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = (new Date(response.google.session.iat*1000)).toLocaleString();authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'exp';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = (new Date(response.google.session.exp*1000)).toLocaleString();authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'user';authn_displayblock_table_td.rowSpan = 4;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'userid';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = response.google.user.userid;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'email';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = response.google.user.email;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'name';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.innerText = response.google.user.name;authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);
						authn_displayblock_table_tr = document.createElement('tr');
						authn_displayblock_table_td = document.createElement('th');authn_displayblock_table_td.innerText = 'icon';authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_td_img = document.createElement('img');
						authn_displayblock_table_td_img.src = response.google.user.icon;
						authn_displayblock_table_td_img.alt = response.google.user.email;
						authn_displayblock_table_td = document.createElement('td');authn_displayblock_table_td.appendChild(authn_displayblock_table_td_img);authn_displayblock_table_tr.appendChild(authn_displayblock_table_td);
						authn_displayblock_table_section.appendChild(authn_displayblock_table_tr);

						authn_displayblock_table.appendChild(authn_displayblock_table_section);
						authn_displayblock.appendChild(authn_displayblock_table);
						/* sample landscape */
						/* sample portrait */
						document.querySelectorAll('.authn_result_portrait.block1').forEach((e)=>{
							e.parentNode.remove();
						});
						authn_displayblock_block0 = document.createElement('div');
						authn_displayblock_block0.classList.add('authn_result_portrait');
						authn_displayblock_block0.classList.add('block1');

						authn_displayblock_block1 = document.createElement('div');
						authn_displayblock_block1.classList.add('block1');
						authn_displayblock_block2 = document.createElement('div');
						authn_displayblock_block2.classList.add('block2');
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h2');
						authn_displayblock_content.innerText = 'http';
						authn_displayblock_block1.appendChild(authn_displayblock_content);
						authn_displayblock_content = document.createElement('h3');
						authn_displayblock_content.innerText = 'code';
						authn_displayblock_block2.appendChild(authn_displayblock_content);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = response.http.code;
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block0.appendChild(authn_displayblock_block1);
						
						authn_displayblock_block1 = document.createElement('div');
						authn_displayblock_block1.classList.add('block1');
						authn_displayblock_block2 = document.createElement('div');
						authn_displayblock_block2.classList.add('block2');
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h2');
						authn_displayblock_content.innerText = 'error';
						authn_displayblock_block1.appendChild(authn_displayblock_content);
						authn_displayblock_content = document.createElement('h3');
						authn_displayblock_content.innerText = 'code';
						authn_displayblock_block2.appendChild(authn_displayblock_content);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = response.error.code;
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block0.appendChild(authn_displayblock_block1);
						
						authn_displayblock_block1 = document.createElement('div');
						authn_displayblock_block1.classList.add('block1');
						authn_displayblock_block2 = document.createElement('div');
						authn_displayblock_block2.classList.add('block2');
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h2');
						authn_displayblock_content.innerText = 'issue_at';
						authn_displayblock_block1.appendChild(authn_displayblock_content);
						authn_displayblock_content = document.createElement('h3');
						authn_displayblock_content.innerText = 'issue_at';
						authn_displayblock_block2.appendChild(authn_displayblock_content);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = (new Date(response.issue_at*1000)).toLocaleString();
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block0.appendChild(authn_displayblock_block1);
						
						authn_displayblock_block1 = document.createElement('div');
						authn_displayblock_block1.classList.add('block1');
						authn_displayblock_block2 = document.createElement('div');
						authn_displayblock_block2.classList.add('block2');
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h2');
						authn_displayblock_content.innerText = 'last_checkpoint';
						authn_displayblock_block1.appendChild(authn_displayblock_content);
						authn_displayblock_content = document.createElement('h3');
						authn_displayblock_content.innerText = 'code';
						authn_displayblock_block2.appendChild(authn_displayblock_content);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = response.last_checkpoint;
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block0.appendChild(authn_displayblock_block1);
						
						authn_displayblock_block1 = document.createElement('div');
						authn_displayblock_block1.classList.add('block1');
						authn_displayblock_block2 = document.createElement('div');
						authn_displayblock_block2.classList.add('block2');
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h2');
						authn_displayblock_content.innerText = 'remote';
						authn_displayblock_block1.appendChild(authn_displayblock_content);
						authn_displayblock_content = document.createElement('h3');
						authn_displayblock_content.innerText = 'address';
						authn_displayblock_block2.appendChild(authn_displayblock_content);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = response.remote;
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block0.appendChild(authn_displayblock_block1);
						
						authn_displayblock_block1 = document.createElement('div');
						authn_displayblock_block1.classList.add('block1');
						authn_displayblock_block2 = document.createElement('div');
						authn_displayblock_block2.classList.add('block2');
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h2');
						authn_displayblock_content.innerText = 'authn';
						authn_displayblock_block1.appendChild(authn_displayblock_content);
						authn_displayblock_content = document.createElement('h3');
						authn_displayblock_content.innerText = 'session';
						authn_displayblock_block2.appendChild(authn_displayblock_content);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('h4');
						authn_displayblock_content.innerText = 'id';
						authn_displayblock_block3.appendChild(authn_displayblock_content);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = response.authn.sessions.id;
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h4');
						authn_displayblock_content.innerText = 'name';
						authn_displayblock_block3.appendChild(authn_displayblock_content);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = response.authn.sessions.name;
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block0.appendChild(authn_displayblock_block1);
						
						authn_displayblock_block1 = document.createElement('div');
						authn_displayblock_block1.classList.add('block1');
						authn_displayblock_block2 = document.createElement('div');
						authn_displayblock_block2.classList.add('block2');
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h2');
						authn_displayblock_content.innerText = 'google';
						authn_displayblock_block1.appendChild(authn_displayblock_content);
						authn_displayblock_content = document.createElement('h3');
						authn_displayblock_content.innerText = 'token';
						authn_displayblock_block2.appendChild(authn_displayblock_content);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('h4');
						authn_displayblock_content.innerText = 'clientId';
						authn_displayblock_block3.appendChild(authn_displayblock_content);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = (params.clientId + '.' + location.host).split('.')[0];
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h4');
						authn_displayblock_content.innerText = 'credential';
						authn_displayblock_block3.appendChild(authn_displayblock_content);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = '****************';
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block2 = document.createElement('div');
						authn_displayblock_block2.classList.add('block2');
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h3');
						authn_displayblock_content.innerText = 'session';
						authn_displayblock_block2.appendChild(authn_displayblock_content);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('h4');
						authn_displayblock_content.innerText = 'iat';
						authn_displayblock_block3.appendChild(authn_displayblock_content);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = (new Date(response.google.session.iat*1000)).toLocaleString();
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h4');
						authn_displayblock_content.innerText = 'exp';
						authn_displayblock_block3.appendChild(authn_displayblock_content);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = (new Date(response.google.session.exp*1000)).toLocaleString();
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block2 = document.createElement('div');
						authn_displayblock_block2.classList.add('block2');
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h3');
						authn_displayblock_content.innerText = 'user';
						authn_displayblock_block2.appendChild(authn_displayblock_content);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('h4');
						authn_displayblock_content.innerText = 'userid';
						authn_displayblock_block3.appendChild(authn_displayblock_content);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = response.google.user.userid;
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h4');
						authn_displayblock_content.innerText = 'email';
						authn_displayblock_block3.appendChild(authn_displayblock_content);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = response.google.user.email;
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h4');
						authn_displayblock_content.innerText = 'name';
						authn_displayblock_block3.appendChild(authn_displayblock_content);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('code');
						authn_displayblock_content.innerText = response.google.user.name;
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block3 = document.createElement('div');
						authn_displayblock_block3.classList.add('block3');
						authn_displayblock_block4 = document.createElement('div');
						authn_displayblock_block4.classList.add('block4');
						authn_displayblock_content = document.createElement('h4');
						authn_displayblock_content.innerText = 'icon';
						authn_displayblock_block3.appendChild(authn_displayblock_content);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_content = document.createElement('img');
						authn_displayblock_content.src = response.google.user.icon;
						authn_displayblock_content.alt = `"${response.google.user.name}" <${response.google.user.email}>`;
						authn_displayblock_block4.appendChild(authn_displayblock_content);
						authn_displayblock_block3.appendChild(authn_displayblock_block4);
						authn_displayblock_block2.appendChild(authn_displayblock_block3);
						authn_displayblock_block1.appendChild(authn_displayblock_block2);
						authn_displayblock_block0.appendChild(authn_displayblock_block1);

						authn_displayblock.appendChild(authn_displayblock_block0);

						/* sample portrait */

						document.querySelectorAll('body').forEach((e,i)=>e.appendChild(authn_displayblock));

						document.querySelectorAll('.g_id_signin').forEach((e,i)=>e.remove());
						document.querySelectorAll('#credential_picker_container').forEach((e,i)=>e.remove());

					} else if ( xhr.readyState === 4 && xhr.status >= 500 ) {
						throw new Error(`Error has occured. error-code=${xhr.status}(Server-error).`);
					} else if ( xhr.readyState === 4 && xhr.status >= 400 ) {
						throw new Error(`Error has occured. error-code=${xhr.status}(Client-error).`);
					} else {
						console.debug( [
							xhr.responseText,
							xhr.readyState,
							xhr.status,
						] );
					}
				}
				xhr.open( 'POST', params.requestUri );
				xhr.setRequestHeader( 'content-type', 'application/x-www-form-urlencoded;charset=UTF-8' );
				xhr.send( 'ts='+(Math.floor((new Date()).getTime()/1000)) + '&credential='+params.credential + '&clientId='+params.clientId );
				
			} catch (excep) {
				console.error(excep.message);
				var result_mesg;
				result_mesg = document.createElement('p');
				result_mesg.innerText = excep.message;
				document.querySelectorAll('.g_id_signin').item( (document.querySelectorAll('.g_id_signin').length-1) ).after(result_mesg);
			} finally {
				fullscreen_wp = document.querySelectorAll('.fullscreen_wp');
				Array.prototype.forEach.call(fullscreen_wp, (e)=>{ e.remove(); });
			}
		}
	</script>
</head>
<body></body>
</html>
