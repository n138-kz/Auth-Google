<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Auth-Google</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://accounts.google.com/gsi/client" async defer></script>
	<script src="https://www.google.com/recaptcha/api.js?render=6LfCHdcUAAAAAOwkHsW_7W7MfoOrvoIw9CXdLRBA"></script>
	<style>
		:root {
			--default-font-size: 16pt;
			--default-margin-padding-size: 0;
			--default-background-color: #F0FFFFFF;
			--default-text-color: #000000FF;
		}
		:root[theme=dark] {
			--default-background-color: #000000FF;
			--default-text-color: #F00000FF;
		}
		html, body {
			margin: var(--default-margin-padding-size);
			padding: var(--default-margin-padding-size);
			background-color: var(--default-background-color);
			color: var(--default-text-color);
			font-size: var(--default-font-size);
		}
		body {
			max-width: 350px;
			margin: 0 auto;
			width: 90%;
			text-align: center;
		}
		@keyframes rotate1 {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}
	</style>
	<style>
		div.div_button {
			padding: 10px 15px;
			border-radius: 50% / 100%;
			margin-top: 1px;
		}
		a {
			text-decoration: none;
		}
		a:hover {
			text-decoration: underline;
		}
	</style>
	<style>
		.g_id_signin iframe {
			margin: 0 auto !important;
		}
	</style>
	<script>
		window.addEventListener('DOMContentLoaded', (e)=>{
			const html_top = document.createElement('a');
			html_top.name='_';
			document.querySelector('body').prepend(html_top);
		}, false);
	</script>
	<script>
		async function sha256(text){
			/**
			* @quote
				https://qiita.com/economist/items/768d2f6a10d54d4fa39f
			* @usage
				sha256(document.querySelector(':root').innerHTML).then(hash => console.log(hash));
			*/
			const uint8  = new TextEncoder().encode(text)
			const digest = await crypto.subtle.digest('SHA-256', uint8)
			return Array.from(new Uint8Array(digest)).map(v => v.toString(16).padStart(2,'0')).join('')
		}
		async function hash_encode(encode, text){
			/**
			* @docs
				https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest
			* @args encode::text
				- SHA-1
				- SHA-256
				- SHA-384
				- SHA-512
			* @args text::text
				.*
			*/
			const uint8  = new TextEncoder().encode(text)
			const digest = await crypto.subtle.digest(encode, uint8)
			return Array.from(new Uint8Array(digest)).map(v => v.toString(16).padStart(2,'0')).join('')
		}
		function getLatestDeployGithub(requestUri) {
			var dom_messages;
			var dom_messages_outputs;
			var dom_messages_code;
			/* fetch */
			fetch(requestUri, {
				method: 'GET',
			})
			.then(response => {
				console.debug(response);
				if (false) {
				} else if ( response.status === 200 ) {
					return response.json()
				} else if ( response.status >= 400 ) {
					throw new Error(`[${response.status}]Error has occured. server-message:${response.message} ${response.documentation_url}`);
				}
			})
			.then(response => response[0].statuses_url)
			.then(deployLatest_url => {
				console.log(deployLatest_url);
				return fetch(deployLatest_url, {
					method: 'GET',
				}).then(response => response.json())
				.then(response => {
					return response[0];
				});
			})
			.then(response => {
				return response;
			})
			.catch(exception => {
				console.error(exception);
			});
		}
		function checkupdate_self() {
			let latestDeployGithub = getLatestDeployGithub('https://api.github.com/repos/n138-kz/mondai_3/deployments');
			/*
			idが違って、stateがsuccessの時ページ再読み込み
			*/
		}
		window.addEventListener('DOMContentLoaded', (e)=>{
			sessionStorage.setItem( (btoa(location.href)).slice(0, 16) + '.'+'github',
			getLatestDeployGithub('https://api.github.com/repos/n138-kz/mondai_3/deployments') );

			checkupdate_self();
			setInterval(checkupdate_self, (300 * 1000)); /* 5min */
		}, false);
		window.addEventListener('DOMContentLoaded', (e)=>{
			let favicon;
			['icon', 'apple-touch-icon', 'favicon'].forEach((e)=>{
				favicon = document.createElement('link');
				favicon.rel = '<link rel="icon" href="/favicon.ico">';
				favicon.rel = 'icon';
				favicon.href = 'https://www.google.com/s2/favicons?size=64&domain=https://google.com/';
				document.querySelectorAll('head').forEach((e)=>e.prepend(favicon));
			});
		}, false);
		window.addEventListener('DOMContentLoaded', (e)=>{
			let header1 = document.createElement('h1');
			let header1_link = document.createElement('a');
			header1_link.href = './';
			header1_link.title = document.title;
			let header1_text = document.createTextNode(document.title);
			header1_link.appendChild(header1_text);
			header1.appendChild(header1_link);
			document.querySelectorAll('body').forEach((e)=>e.prepend(header1));
		}, false);
	</script>
	<script defer>
		window.addEventListener('DOMContentLoaded', (e)=>{
			let g_id_signin = document.createElement('div');
			g_id_signin.classList.add('div_button');
			g_id_signin.classList.add('g_id_signin');
			g_id_signin.dataset.type = 'standard';
			g_id_signin.dataset.shape = 'rectangular';
			g_id_signin.dataset.theme = 'outline';
			g_id_signin.dataset.text = 'signin_with';
			g_id_signin.dataset.size = 'large';
			g_id_signin.dataset.logo_alignment = 'left';
			document.querySelector('body').appendChild(g_id_signin);

			let g_id_onload = document.createElement('div');
			g_id_onload.id = 'g_id_onload';
			g_id_onload.dataset.client_id = '784669840257-i0a06p3o6g8k0k1tk26jj09li1q2acud.apps.googleusercontent.com';
			g_id_onload.dataset.context='signin';
			g_id_onload.dataset.login_uri = 'https://n138-kz.github.io';
			g_id_onload.dataset.callback = 'onSignIn';
			g_id_onload.dataset.ux_mode='popup';
			g_id_onload.dataset.auto_select='true';
			g_id_onload.dataset.itp_support='true';
			document.querySelector('body').appendChild(g_id_onload);
		}, false);
	</script>
	<style>
		table.authz_result_landscape {
			background-color: var(--default-background-color);
		}
		table.authz_result_landscape th {
			text-align: center;
		}
		table.authz_result_landscape td {
			text-align: left;
		}
		div.authz_result_portrait {
			background-color: var(--default-background-color);
			text-align: left;
		}
		div.authz_result_portrait .block2,
		div.authz_result_portrait .block3,
		div.authz_result_portrait .block4 {
			margin-left: 50px;
		}
		div.authz_result_portrait h2,
		div.authz_result_portrait h3,
		div.authz_result_portrait h4 {
			margin: 0;
		}
		@media all {
			.authz_result_landscape {
				display: none;
			}
			.authz_result_portrait {
				display: none;
			}
		}
		@media screen and (orientation: landscape) {
			table.authz_result_landscape {
				display: table;
			}
		}
		@media screen and (orientation: portrait) {
			div.authz_result_portrait {
				display: grid;
			}
		}
	</style>
	<script>
		function onSignIn(params) {
			let fullscreen_wp;
			fullscreen_wp = document.querySelectorAll('.fullscreen_wp');
			Array.prototype.forEach.call(fullscreen_wp, (e)=>{ e.remove(); });
			fullscreen_wp = document.createElement('div');
			fullscreen_wp.style.backgroundColor = '#c0c0c0c0'; /* near eq silver(#C0C0C0) */
			fullscreen_wp.style.left = '0px';
			fullscreen_wp.style.top = '0px';
			fullscreen_wp.style.position = 'fixed';
			fullscreen_wp.style.width = '100%';
			fullscreen_wp.style.height = '100%';
			fullscreen_wp.style.zIndex = '10000';
			fullscreen_wp.classList.add('fullscreen_wp');
			let loading_img = document.createElement('img');
			loading_img.src = '12675.svg';
			loading_img.alt = '12675';
			loading_img.style.maxWidth = '80%';
			loading_img.style.maxHeight = '80%';
			loading_img.style.animationName = 'rotate1';
			loading_img.style.animationDuration = '1.5s';
			loading_img.style.animationTimingFunction = 'ease';
			loading_img.style.animationIterationCount = 'infinite';
			fullscreen_wp.appendChild(loading_img);
			document.querySelector('body').appendChild(fullscreen_wp);
			console.log([params, JSON.stringify(params)]);

			try {
				let xhr = new XMLHttpRequest();
				xhr.onreadystatechange = () => {
					if ( xhr.readyState === 4 && xhr.status === 200 ) {
						let responseText = xhr.responseText;
						let response = JSON.parse(responseText);
						console.log(response);
						/* Authzed */
						sessionStorage.setItem( (btoa(location.href)).slice(0, 16) + '.'+'googleauthz',
							JSON.stringify({
								credential: {
									token: params.credential,
									clientId: params.clientId,
									client_id: params.clientId,
									iat: response.google.session.iat,
									iat_humanable: {
										jst: new Date((response.google.session.iat)*1000).toLocaleString('ja-JP', { timeZone: 'jst' }),
										utc: new Date((response.google.session.iat)*1000).toUTCString(),
									},
									exp: response.google.session.exp,
									exp_humanable: {
										jst: new Date((response.google.session.exp)*1000).toLocaleString('ja-JP', { timeZone: 'jst' }),
										utc: new Date((response.google.session.exp)*1000).toUTCString(),
									},
									remote: response.remote,
								},
								sessions: {
									id: response.authz.sessions.id,
									name: response.authz.sessions.name,
								},
								iat: response.issue_at,
							})
						);

						authz_displayblock = document.createElement('div');
						authz_displayblock.style.backgroundColor = '#F0FFFF';

						/*
						* @sample
							response = {
								http: {
									code: 200
								},
								error: {
									code: 0
								},
								issue_at: (new Date()).getTime()/1000,
								last_checkpoint: 119,
								remote: '127.0.0.1:65535',
								google: {
									session: {
										iat: (new Date()).getTime()/1000,
										exp: (new Date()).getTime()/1000,
									},
									user: {
										userid: 'test-id-01',
										email: 'test@example.net',
										name: 'test, test',
										icon: 'https://lh3.googleusercontent.com/a/ACg8ocKm8zMAS24gpR1uksfUAXPG5gDSevDZdYPgtfXetrK0nVRN=s96-c',
									}
								}
							}
						/* * */
						/* sample landscape */
						authz_displayblock_table = document.createElement('table');
						authz_displayblock_table.classList.add('authz_result_landscape');
						authz_displayblock_table.border = 1;
						authz_displayblock_table_section = document.createElement('tbody');
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'http';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'code';authz_displayblock_table_td.colSpan = 2;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = response.http.code;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'error';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'code';authz_displayblock_table_td.colSpan = 2;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = response.error.code;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'issue_at';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'issue_at';authz_displayblock_table_td.colSpan = 2;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = (new Date(response.issue_at*1000)).toLocaleString();authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'last_checkpoint';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'code';authz_displayblock_table_td.colSpan = 2;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = response.last_checkpoint;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'remote';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'address';authz_displayblock_table_td.colSpan = 2;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = response.remote;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'authz';authz_displayblock_table_td.rowSpan = 2;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'session';authz_displayblock_table_td.rowSpan = 2;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'id';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = response.authz.sessions.id;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'name';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = response.authz.sessions.name;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'google';authz_displayblock_table_td.rowSpan = 8;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'token';authz_displayblock_table_td.rowSpan = 2;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'clientId';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = (params.clientId + '.' + location.host).split('.')[0];authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'credential';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = '****************';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'session';authz_displayblock_table_td.rowSpan = 2;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'iat';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = (new Date(response.google.session.iat*1000)).toLocaleString();authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'exp';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = (new Date(response.google.session.exp*1000)).toLocaleString();authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'user';authz_displayblock_table_td.rowSpan = 4;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'userid';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = response.google.user.userid;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'email';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = response.google.user.email;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'name';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.innerText = response.google.user.name;authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);
						authz_displayblock_table_tr = document.createElement('tr');
						authz_displayblock_table_td = document.createElement('th');authz_displayblock_table_td.innerText = 'icon';authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_td_img = document.createElement('img');
						authz_displayblock_table_td_img.src = response.google.user.icon;
						authz_displayblock_table_td_img.alt = response.google.user.email;
						authz_displayblock_table_td = document.createElement('td');authz_displayblock_table_td.appendChild(authz_displayblock_table_td_img);authz_displayblock_table_tr.appendChild(authz_displayblock_table_td);
						authz_displayblock_table_section.appendChild(authz_displayblock_table_tr);

						authz_displayblock_table.appendChild(authz_displayblock_table_section);
						authz_displayblock.appendChild(authz_displayblock_table);
						/* sample landscape */
						/* sample portrait */
						document.querySelectorAll('.authz_result_portrait.block1').forEach((e)=>{
							e.parentNode.remove();
						});
						authz_displayblock_block0 = document.createElement('div');
						authz_displayblock_block0.classList.add('authz_result_portrait');
						authz_displayblock_block0.classList.add('block1');

						authz_displayblock_block1 = document.createElement('div');
						authz_displayblock_block1.style.textAlign = 'left';
						authz_displayblock_block1.classList.add('block1');
						authz_displayblock_block2 = document.createElement('div');
						authz_displayblock_block2.classList.add('block2');
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h2');
						authz_displayblock_content.innerText = 'http';
						authz_displayblock_block1.appendChild(authz_displayblock_content);
						authz_displayblock_content = document.createElement('h3');
						authz_displayblock_content.innerText = 'code';
						authz_displayblock_block2.appendChild(authz_displayblock_content);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = response.http.code;
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block0.appendChild(authz_displayblock_block1);
						
						authz_displayblock_block1 = document.createElement('div');
						authz_displayblock_block1.style.textAlign = 'left';
						authz_displayblock_block1.classList.add('block1');
						authz_displayblock_block2 = document.createElement('div');
						authz_displayblock_block2.classList.add('block2');
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h2');
						authz_displayblock_content.innerText = 'error';
						authz_displayblock_block1.appendChild(authz_displayblock_content);
						authz_displayblock_content = document.createElement('h3');
						authz_displayblock_content.innerText = 'code';
						authz_displayblock_block2.appendChild(authz_displayblock_content);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = response.error.code;
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block0.appendChild(authz_displayblock_block1);
						
						authz_displayblock_block1 = document.createElement('div');
						authz_displayblock_block1.style.textAlign = 'left';
						authz_displayblock_block1.classList.add('block1');
						authz_displayblock_block2 = document.createElement('div');
						authz_displayblock_block2.classList.add('block2');
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h2');
						authz_displayblock_content.innerText = 'issue_at';
						authz_displayblock_block1.appendChild(authz_displayblock_content);
						authz_displayblock_content = document.createElement('h3');
						authz_displayblock_content.innerText = 'issue_at';
						authz_displayblock_block2.appendChild(authz_displayblock_content);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = (new Date(response.issue_at*1000)).toLocaleString();
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block0.appendChild(authz_displayblock_block1);
						
						authz_displayblock_block1 = document.createElement('div');
						authz_displayblock_block1.style.textAlign = 'left';
						authz_displayblock_block1.classList.add('block1');
						authz_displayblock_block2 = document.createElement('div');
						authz_displayblock_block2.classList.add('block2');
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h2');
						authz_displayblock_content.innerText = 'last_checkpoint';
						authz_displayblock_block1.appendChild(authz_displayblock_content);
						authz_displayblock_content = document.createElement('h3');
						authz_displayblock_content.innerText = 'code';
						authz_displayblock_block2.appendChild(authz_displayblock_content);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = response.last_checkpoint;
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block0.appendChild(authz_displayblock_block1);
						
						authz_displayblock_block1 = document.createElement('div');
						authz_displayblock_block1.style.textAlign = 'left';
						authz_displayblock_block1.classList.add('block1');
						authz_displayblock_block2 = document.createElement('div');
						authz_displayblock_block2.classList.add('block2');
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h2');
						authz_displayblock_content.innerText = 'remote';
						authz_displayblock_block1.appendChild(authz_displayblock_content);
						authz_displayblock_content = document.createElement('h3');
						authz_displayblock_content.innerText = 'address';
						authz_displayblock_block2.appendChild(authz_displayblock_content);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = response.remote;
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block0.appendChild(authz_displayblock_block1);
						
						authz_displayblock_block1 = document.createElement('div');
						authz_displayblock_block1.style.textAlign = 'left';
						authz_displayblock_block1.classList.add('block1');
						authz_displayblock_block2 = document.createElement('div');
						authz_displayblock_block2.classList.add('block2');
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h2');
						authz_displayblock_content.innerText = 'authz';
						authz_displayblock_block1.appendChild(authz_displayblock_content);
						authz_displayblock_content = document.createElement('h3');
						authz_displayblock_content.innerText = 'session';
						authz_displayblock_block2.appendChild(authz_displayblock_content);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('h4');
						authz_displayblock_content.innerText = 'id';
						authz_displayblock_block3.appendChild(authz_displayblock_content);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = response.authz.sessions.id;
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h4');
						authz_displayblock_content.innerText = 'name';
						authz_displayblock_block3.appendChild(authz_displayblock_content);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = response.authz.sessions.name;
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block0.appendChild(authz_displayblock_block1);
						
						authz_displayblock_block1 = document.createElement('div');
						authz_displayblock_block1.style.textAlign = 'left';
						authz_displayblock_block1.classList.add('block1');
						authz_displayblock_block2 = document.createElement('div');
						authz_displayblock_block2.classList.add('block2');
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h2');
						authz_displayblock_content.innerText = 'google';
						authz_displayblock_block1.appendChild(authz_displayblock_content);
						authz_displayblock_content = document.createElement('h3');
						authz_displayblock_content.innerText = 'token';
						authz_displayblock_block2.appendChild(authz_displayblock_content);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('h4');
						authz_displayblock_content.innerText = 'clientId';
						authz_displayblock_block3.appendChild(authz_displayblock_content);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = (params.clientId + '.' + location.host).split('.')[0];
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h4');
						authz_displayblock_content.innerText = 'credential';
						authz_displayblock_block3.appendChild(authz_displayblock_content);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = '****************';
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block2 = document.createElement('div');
						authz_displayblock_block2.classList.add('block2');
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h3');
						authz_displayblock_content.innerText = 'session';
						authz_displayblock_block2.appendChild(authz_displayblock_content);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('h4');
						authz_displayblock_content.innerText = 'iat';
						authz_displayblock_block3.appendChild(authz_displayblock_content);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = (new Date(response.google.session.iat*1000)).toLocaleString();
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h4');
						authz_displayblock_content.innerText = 'exp';
						authz_displayblock_block3.appendChild(authz_displayblock_content);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = (new Date(response.google.session.exp*1000)).toLocaleString();
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block2 = document.createElement('div');
						authz_displayblock_block2.classList.add('block2');
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h3');
						authz_displayblock_content.innerText = 'user';
						authz_displayblock_block2.appendChild(authz_displayblock_content);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('h4');
						authz_displayblock_content.innerText = 'userid';
						authz_displayblock_block3.appendChild(authz_displayblock_content);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = response.google.user.userid;
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h4');
						authz_displayblock_content.innerText = 'email';
						authz_displayblock_block3.appendChild(authz_displayblock_content);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = response.google.user.email;
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h4');
						authz_displayblock_content.innerText = 'name';
						authz_displayblock_block3.appendChild(authz_displayblock_content);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('code');
						authz_displayblock_content.innerText = response.google.user.name;
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block3 = document.createElement('div');
						authz_displayblock_block3.classList.add('block3');
						authz_displayblock_block4 = document.createElement('div');
						authz_displayblock_block4.classList.add('block4');
						authz_displayblock_content = document.createElement('h4');
						authz_displayblock_content.innerText = 'icon';
						authz_displayblock_block3.appendChild(authz_displayblock_content);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_content = document.createElement('img');
						authz_displayblock_content.src = response.google.user.icon;
						authz_displayblock_content.alt = `"${response.google.user.name}" <${response.google.user.email}>`;
						authz_displayblock_block4.appendChild(authz_displayblock_content);
						authz_displayblock_block3.appendChild(authz_displayblock_block4);
						authz_displayblock_block2.appendChild(authz_displayblock_block3);
						authz_displayblock_block1.appendChild(authz_displayblock_block2);
						authz_displayblock_block0.appendChild(authz_displayblock_block1);

						authz_displayblock.appendChild(authz_displayblock_block0);

						/* sample portrait */

						document.querySelectorAll('body').forEach((e,i)=>e.appendChild(authz_displayblock));

						document.querySelectorAll('.g_id_signin').forEach((e,i)=>e.remove());
						document.querySelectorAll('#credential_picker_container').forEach((e,i)=>e.remove());

					} else if ( xhr.readyState === 4 && xhr.status >= 500 ) {
						throw new Error(`Error has occured. error-code=${xhr.status}(Server-error).`);
					} else if ( xhr.readyState === 4 && xhr.status >= 400 ) {
						throw new Error(`Error has occured. error-code=${xhr.status}(Client-error).`);
					} else {
						console.debug( [
							xhr.responseText,
							xhr.readyState,
							xhr.status,
						] );
					}
				}
				xhr.open( 'POST', 'https://authz.n138.jp/google/' );
				xhr.setRequestHeader( 'content-type', 'application/x-www-form-urlencoded;charset=UTF-8' );
				xhr.send( 'ts='+(Math.floor((new Date()).getTime()/1000)) + '&credential='+params.credential + '&clientId='+params.clientId );
				
			} catch (excep) {
				console.error(excep.message);
				var result_mesg;
				result_mesg = document.createElement('p');
				result_mesg.innerText = excep.message;
				document.querySelectorAll('.g_id_signin').item( (document.querySelectorAll('.g_id_signin').length-1) ).after(result_mesg);
			} finally {
				fullscreen_wp = document.querySelectorAll('.fullscreen_wp');
				Array.prototype.forEach.call(fullscreen_wp, (e)=>{ e.remove(); });
			}
		}
	</script>
</head>
<body></body>
</html>
